### ============================================
### GRAPHQL_TEST_QUERIES.http (PROMOTIONS + ORDERS + KPI)
### ============================================

@host = https://localhost:5135
@token = YOUR_JWT_TOKEN_HERE

@page =1
@pageSize =20

# Example IDs (edit)
@promotionId =1
@orderId =1

# KPI examples (edit)
@saleId =3
@year =2025
@month =12
@kpiTierId =1

# USER examples (edit)
@userId =1

### ------------------------------------------------
### USERS
### ------------------------------------------------

### U1) List users (Admin/Moderator)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: UserFilterInput) { users(pagination: $pagination, filter: $filter) { statusCode success message data { page pageSize totalItems totalPages items { userId username fullName isActive createdAt roles } } } }",
 "variables": {
 "pagination": { "page": {{page}}, "pageSize": {{pageSize}} },
 "filter": { "search": null, "isActive": null, "role": null }
 }
}

### U2) List SALES only (filter by role=Sale)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: UserFilterInput) { users(pagination: $pagination, filter: $filter) { statusCode success message data { page pageSize totalItems totalPages items { userId username fullName isActive roles } } } }",
 "variables": {
 "pagination": { "page":1, "pageSize":50 },
 "filter": { "role": "SALE", "isActive": true }
 }
}

### U3) User by id
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($id: Int!) { userById(userId: $id) { statusCode success message data { userId username fullName isActive createdAt roles } } }",
 "variables": { "id": {{userId}} }
}

### U4) Create user (Admin only)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CreateUserInput!) { createUser(input: $input) { statusCode success message data { userId username fullName isActive roles createdAt } } }",
 "variables": {
 "input": {
 "username": "sale_test_01",
 "password": "sale123",
 "fullName": "Sale Test01",
 "isActive": true,
 "roles": ["SALE"]
 }
 }
}

### U5) Update user (Admin/Moderator)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateUserInput!) { updateUser(userId: $id, input: $input) { statusCode success message data { userId username fullName isActive roles } } }",
 "variables": {
 "id": {{userId}},
 "input": {
 "fullName": "Updated FullName",
 "isActive": true,
 "roles": ["SALE"]
 }
 }
}

### U6) Set user active/inactive (Admin/Moderator) - soft delete / restore
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $isActive: Boolean!) { setUserActive(userId: $id, isActive: $isActive) { statusCode success message data } }",
 "variables": {
 "id": {{userId}},
 "isActive": false
 }
}

### U7) Reset user password (Admin only)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: ResetPasswordInput!) { resetUserPassword(input: $input) { statusCode success message data } }",
 "variables": {
 "input": {
 "userId": {{userId}},
 "newPassword": "new_password_123"
 }
 }
}

### ------------------------------------------------
### PROMOTIONS
### ------------------------------------------------

###1) Create PRODUCT promotion (requires productIds)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CreatePromotionInput!) { createPromotion(input: $input) { success statusCode message data { promotionId name discountPercent startDate endDate scope productIds categoryIds } } }",
 "variables": {
 "input": {
 "name": "Product -15%",
 "discountPercent":15,
 "startDate": "2025-12-19T00:00:00Z",
 "endDate": "2025-12-31T23:59:59Z",
 "scope": "PRODUCT",
 "productIds": [1,2]
 }
 }
}

###2) Create CATEGORY promotion (requires categoryIds)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CreatePromotionInput!) { createPromotion(input: $input) { success statusCode message data { promotionId name discountPercent startDate endDate scope productIds categoryIds } } }",
 "variables": {
 "input": {
 "name": "Category -10%",
 "discountPercent":10,
 "startDate": "2025-12-19T00:00:00Z",
 "endDate": "2025-12-31T23:59:59Z",
 "scope": "CATEGORY",
 "categoryIds": [1]
 }
 }
}

###3) Create ORDER promotion (no productIds/categoryIds)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CreatePromotionInput!) { createPromotion(input: $input) { success statusCode message data { promotionId name discountPercent startDate endDate scope } } }",
 "variables": {
 "input": {
 "name": "Order -5%",
 "discountPercent":5,
 "startDate": "2025-12-19T00:00:00Z",
 "endDate": "2025-12-31T23:59:59Z",
 "scope": "ORDER"
 }
 }
}

###4) List promotions (FE: scope + onlyActive + paging)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: PromotionFilterInput) { promotions(pagination: $pagination, filter: $filter) { statusCode success message data { page pageSize totalItems totalPages items { promotionId name discountPercent startDate endDate scope productIds categoryIds } } } }",
 "variables": {
 "pagination": { "page": {{page}}, "pageSize": {{pageSize}} },
 "filter": { "scope": null, "onlyActive": false }
 }
}

###5) List promotions - only ACTIVE ORDER (FE chọn promotion cho Order)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: PromotionFilterInput) { promotions(pagination: $pagination, filter: $filter) { statusCode success message data { page pageSize totalItems totalPages items { promotionId name discountPercent startDate endDate scope } } } }",
 "variables": {
 "pagination": { "page":1, "pageSize":50 },
 "filter": { "scope": "ORDER", "onlyActive": true }
 }
}

###6) Promotion by id
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($id: Int!) { promotionById(promotionId: $id) { statusCode success message data { promotionId name discountPercent startDate endDate scope productIds categoryIds } } }",
 "variables": { "id": {{promotionId}} }
}

###7) Update promotion (only when NOT active)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdatePromotionInput!) { updatePromotion(promotionId: $id, input: $input) { success statusCode message data { promotionId name discountPercent startDate endDate scope productIds categoryIds } } }",
 "variables": {
 "id": {{promotionId}},
 "input": {
 "name": "Order -7% (updated)",
 "discountPercent":7,
 "startDate": "2026-01-01T00:00:00Z",
 "endDate": "2026-01-31T23:59:59Z",
 "scope": "ORDER"
 }
 }
}

###8) Delete promotion
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!) { deletePromotion(promotionId: $id) { success statusCode message } }",
 "variables": { "id": {{promotionId}} }
}

### ------------------------------------------------
### ORDERS
### ------------------------------------------------

###9) Create order (promotionIds: ONLY ORDER-scope)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CreateOrderInput!) { createOrder(input: $input) { success statusCode message data { orderId status totalPrice subtotal orderDiscountAmount orderDiscountPercentApplied promotionIds createdAt items { orderItemId productId productName quantity unitPrice totalPrice } } } }",
 "variables": {
 "input": {
 "customerId":1,
 "saleId":3,
 "promotionIds": [7],
 "items": [
 { "productId":1, "quantity":2 },
 { "productId":2, "quantity":1 }
 ]
 }
 }
}

###10) List orders (Order list screen)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: OrderFilterInput, $dateRange: DateRangeInput) { orders(pagination: $pagination, filter: $filter, dateRange: $dateRange) { statusCode success message data { page pageSize totalItems totalPages items { orderId status createdAt customerName saleName subtotal orderDiscountAmount totalPrice itemsCount } } } }",
 "variables": {
 "pagination": { "page": {{page}}, "pageSize": {{pageSize}} },
 "filter": null,
 "dateRange": null
 }
}

###11) Order by id (detail screen)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($id: Int!) { orderById(orderId: $id) { statusCode success message data { orderId status totalPrice subtotal orderDiscountAmount orderDiscountPercentApplied promotionIds customerId customerName saleId saleName createdAt items { orderItemId productId productName quantity unitPrice totalPrice } } } }",
 "variables": { "id": {{orderId}} }
}

###12) Update order - replace promotions ONLY
### - empty array [] => remove all promotions
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateOrderInput!) { updateOrder(orderId: $id, input: $input) { success statusCode message data { orderId status subtotal orderDiscountAmount totalPrice promotionIds } } }",
 "variables": {
 "id": {{orderId}},
 "input": {
 "promotionIds": [7]
 }
 }
}

###13) Update order - remove all promotions
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateOrderInput!) { updateOrder(orderId: $id, input: $input) { success statusCode message data { orderId status subtotal orderDiscountAmount totalPrice promotionIds } } }",
 "variables": {
 "id": {{orderId}},
 "input": {
 "promotionIds": []
 }
 }
}

###14) Update order - replace items ONLY
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateOrderInput!) { updateOrder(orderId: $id, input: $input) { success statusCode message data { orderId status subtotal orderDiscountAmount totalPrice promotionIds items { orderItemId productId productName quantity unitPrice totalPrice } } } }",
 "variables": {
 "id": {{orderId}},
 "input": {
 "items": [
 { "productId":1, "quantity":1 }
 ]
 }
 }
}

###15) Update order - replace BOTH items + promotions
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateOrderInput!) { updateOrder(orderId: $id, input: $input) { success statusCode message data { orderId status subtotal orderDiscountAmount totalPrice promotionIds items { orderItemId productId productName quantity unitPrice totalPrice } } } }",
 "variables": {
 "id": {{orderId}},
 "input": {
 "promotionIds": [7],
 "items": [
 { "productId":1, "quantity":2 },
 { "productId":2, "quantity":1 }
 ]
 }
 }
}

###16) Mark order as PAID
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!) { updateOrder(orderId: $id, input: { status: PAID }) { success statusCode message data { orderId status totalPrice } } }",
 "variables": { "id": {{orderId}} }
}

###17) Try update Paid order (should fail)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateOrderInput!) { updateOrder(orderId: $id, input: $input) { success statusCode message data { orderId status totalPrice } } }",
 "variables": {
 "id": {{orderId}},
 "input": { "promotionIds": [] }
 }
}

###18) Delete order
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!) { deleteOrder(orderId: $id) { success statusCode message } }",
 "variables": { "id": {{orderId}} }
}

### ------------------------------------------------
### KPI
### ------------------------------------------------

###19) KPI - list tiers
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: KpiTierFilterInput) { kpiTiers(pagination: $pagination, filter: $filter) { statusCode success message data { page pageSize totalItems totalPages items { kpiTierId name minRevenue bonusPercent description displayOrder } } } }",
 "variables": { "pagination": { "page":1, "pageSize":10 }, "filter": null }
}

###20) KPI - create tier
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CreateKpiTierInput!) { createKpiTier(input: $input) { statusCode success message data { kpiTierId name minRevenue bonusPercent description displayOrder } } }",
 "variables": {
 "input": {
 "name": "Diamond",
 "minRevenue":250,
 "bonusPercent":15,
 "description": "Đạt >=250% target tháng - Thưởng thêm15%",
 "displayOrder":5
 }
 }
}

###21) KPI - update tier
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateKpiTierInput!) { updateKpiTier(kpiTierId: $id, input: $input) { statusCode success message data { kpiTierId name minRevenue bonusPercent description displayOrder } } }",
 "variables": {
 "id": {{kpiTierId}},
 "input": {
 "name": "Bronze",
 "minRevenue":100,
 "bonusPercent":2,
 "description": "Đạt >=100% target tháng - Thưởng thêm2%",
 "displayOrder":1
 }
 }
}

###22) KPI - delete tier
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!) { deleteKpiTier(kpiTierId: $id) { statusCode success message } }",
 "variables": { "id": {{kpiTierId}} }
}

###23) KPI - set monthly target
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: SetMonthlyTargetInput!) { setMonthlyTarget(input: $input) { statusCode success message data { saleKpiTargetId saleId saleName year month targetRevenue actualRevenue progress remainingRevenue kpiTierId kpiTierName bonusAmount calculatedAt createdAt } } }",
 "variables": {
 "input": {
 "saleId": {{saleId}},
 "year": {{year}},
 "month": {{month}},
 "targetRevenue":150000000
 }
 }
}

###24) KPI - list targets
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: SaleKpiTargetFilterInput) { saleKpiTargets(pagination: $pagination, filter: $filter) { statusCode success message data { page pageSize totalItems totalPages items { saleKpiTargetId saleId saleName year month targetRevenue actualRevenue progress remainingRevenue kpiTierName bonusAmount calculatedAt createdAt } } } }",
 "variables": { "pagination": { "page":1, "pageSize":10 }, "filter": { "saleId": null, "year": {{year}}, "month": {{month}} } }
}

###25) KPI - dashboard (estimate, not persisted)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($input: KpiDashboardInput!) { kpiDashboard(input: $input) { statusCode success message data { saleId saleName currentYear currentMonth targetRevenue actualRevenue progress remainingRevenue estimatedBaseCommission estimatedBonusCommission estimatedTotalCommission currentKpiTierId currentKpiTierName totalOrdersThisMonth totalOrdersPaid availableTiers { kpiTierId name minRevenue bonusPercent displayOrder } } } }",
 "variables": { "input": { "saleId": {{saleId}}, "year": {{year}}, "month": {{month}} } }
}

###26) KPI - calculate monthly KPI (persist to KpiCommissions)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CalculateMonthlyKpiInput!) { calculateMonthlyKpi(input: $input) { statusCode success message data { kpiCommissionId saleId saleName year month baseCommission bonusCommission totalCommission kpiTierId kpiTierName totalRevenue totalOrders calculatedAt } } }",
 "variables": { "input": { "year": {{year}}, "month": {{month}} } }
}

###27) KPI - list KPI commissions
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: KpiCommissionFilterInput) { kpiCommissions(pagination: $pagination, filter: $filter) { statusCode success message data { page pageSize totalItems totalPages items { kpiCommissionId saleId saleName year month baseCommission bonusCommission totalCommission kpiTierName totalRevenue totalOrders calculatedAt } } } }",
 "variables": { "pagination": { "page":1, "pageSize":10 }, "filter": { "saleId": {{saleId}}, "year": {{year}}, "month": {{month}} } }
}

### ------------------------------------------------
### AUTH
### ------------------------------------------------

### A1) Login (get JWT)
POST {{host}}/graphql
Content-Type: application/json

{
 "query": "mutation($input: LoginInput!) { login(input: $input) { statusCode success message data { userId username fullName roles token } } }",
 "variables": { "input": { "username": "admin", "password": "admin123" } }
}

### ------------------------------------------------
### CATEGORIES
### ------------------------------------------------

@categoryId =1

### CA1) List categories
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $search: $search) { categories(pagination: $pagination, search: $search) { statusCode success message data { page pageSize totalItems totalPages items { categoryId name description productCount } } } }",
 "variables": { "pagination": { "page": {{page}}, "pageSize": {{pageSize}} }, "search": null }
}

### CA2) Category by id
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($id: Int!) { categoryById(categoryId: $id) { statusCode success message data { categoryId name description productCount } } }",
 "variables": { "id": {{categoryId}} }
}

### CA3) Create category (Admin/Moderator)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CreateCategoryInput!) { createCategory(input: $input) { statusCode success message data { categoryId name description productCount } } }",
 "variables": { "input": { "name": "Accessories", "description": "Cables, chargers, adapters" } }
}

### CA4) Update category (Admin/Moderator)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateCategoryInput!) { updateCategory(categoryId: $id, input: $input) { statusCode success message data { categoryId name description productCount } } }",
 "variables": { "id": {{categoryId}}, "input": { "name": "Accessories (Updated)", "description": "Updated" } }
}

### CA5) Delete category (Admin/Moderator)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!) { deleteCategory(categoryId: $id) { statusCode success message data { categoryId } } }",
 "variables": { "id": {{categoryId}} }
}

### ------------------------------------------------
### PRODUCTS
### ------------------------------------------------

@productId =1

### PRD1) List products
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: ProductFilterInput, $sort: ProductSortInput) { products(pagination: $pagination, filter: $filter, sort: $sort) { statusCode success message data { page pageSize totalItems totalPages items { productId sku name salePrice discountPct finalPrice stockQuantity categoryName } } } }",
 "variables": { "pagination": { "page": {{page}}, "pageSize": {{pageSize}} }, "filter": { "search": null, "categoryId": null, "minPrice": null, "maxPrice": null }, "sort": { "field": "NAME", "asc": true } }
}

### PRD2) Product by id
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($id: Int!) { productById(productId: $id) { statusCode success message data { productId sku name importPrice salePrice discountPct finalPrice stockQuantity description categoryId categoryName imagePaths } } }",
 "variables": { "id": {{productId}} }
}

### PRD3) Create product (Admin/Moderator)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CreateProductInput!) { createProduct(input: $input) { statusCode success message data { productId sku name salePrice stockQuantity categoryId categoryName } } }",
 "variables": { "input": { "sku": "TEST-001", "name": "Test Product", "importPrice":100000, "salePrice":150000, "stockQuantity":10, "description": "Test", "categoryId": {{categoryId}}, "imagePaths": [] } }
}

### PRD4) Update product (Admin/Moderator)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateProductInput!) { updateProduct(productId: $id, input: $input) { statusCode success message data { productId sku name salePrice stockQuantity categoryId categoryName } } }",
 "variables": { "id": {{productId}}, "input": { "name": "Test Product (Updated)", "stockQuantity":20 } }
}

### PRD5) Delete product (Admin/Moderator)
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!) { deleteProduct(productId: $id) { statusCode success message } }",
 "variables": { "id": {{productId}} }
}

### ------------------------------------------------
### CUSTOMERS
### ------------------------------------------------

@customerId =1

### CU1) List customers
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($pagination: PaginationInput, $filter: CustomerFilterInput) { customers(pagination: $pagination, filter: $filter) { statusCode success message data { page pageSize totalItems totalPages items { customerId name phone email address orderCount } } } }",
 "variables": { "pagination": { "page": {{page}}, "pageSize": {{pageSize}} }, "filter": { "search": null } }
}

### CU2) Customer by id
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($id: Int!) { customerById(customerId: $id) { statusCode success message data { customerId name phone email address orderCount } } }",
 "variables": { "id": {{customerId}} }
}

### CU3) Create customer
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($input: CreateCustomerInput!) { createCustomer(input: $input) { statusCode success message data { customerId name phone email address orderCount } } }",
 "variables": { "input": { "name": "New Customer", "phone": "0900000000", "email": "new@example.com", "address": "HCM" } }
}

### CU4) Update customer
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!, $input: UpdateCustomerInput!) { updateCustomer(customerId: $id, input: $input) { statusCode success message data { customerId name phone email address orderCount } } }",
 "variables": { "id": {{customerId}}, "input": { "address": "Updated Address" } }
}

### CU5) Delete customer
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($id: Int!) { deleteCustomer(customerId: $id) { statusCode success message } }",
 "variables": { "id": {{customerId}} }
}

### ------------------------------------------------
### PROMOTION (EXTRA)
### ------------------------------------------------

@productId =1

### PX1) Best discount percent for a product
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($productId: Int!, $at: DateTime) { bestDiscountPct(productId: $productId, at: $at) { statusCode success message data } }",
 "variables": { "productId": {{productId}}, "at": null }
}

### ------------------------------------------------
### DASHBOARD (Admin/Moderator)
### ------------------------------------------------

### D1) Overview
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query { reportOverview { statusCode success message data { totalProducts totalOrdersToday revenueToday } } }"
}

### D2) Low stock products
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($threshold: Int, $take: Int) { reportLowStockProducts(threshold: $threshold, take: $take) { statusCode success message data { productId sku name stockQuantity } } }",
 "variables": { "threshold":5, "take":5 }
}

### D3) Top selling products
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($dateRange: DateRangeInput, $take: Int) { reportTopSellingProducts(dateRange: $dateRange, take: $take) { statusCode success message data { productId sku name totalQuantity totalRevenue } } }",
 "variables": { "dateRange": null, "take":5 }
}

### D4) Recent orders
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($take: Int) { reportRecentOrders(take: $take) { statusCode success message data { orderId status createdAt totalPrice customerName saleName } } }",
 "variables": { "take":3 }
}

### D5) Daily revenue in month
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($year: Int, $month: Int) { reportDailyRevenueInMonth(year: $year, month: $month) { statusCode success message data { date revenue } } }",
 "variables": { "year": null, "month": null }
}

### ------------------------------------------------
### REPORTS (Admin/Moderator)
### ------------------------------------------------

### R1) Product sales series
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($dateRange: DateRangeInput!, $groupBy: ReportGroupBy!, $filter: ProductSalesReportFilterInput) { reportProductSalesSeries(dateRange: $dateRange, groupBy: $groupBy, filter: $filter) { statusCode success message data { productId sku name points { period value } } } }",
 "variables": { "dateRange": { "from": "2025-12-01T00:00:00Z", "to": "2025-12-31T00:00:00Z" }, "groupBy": "DAY", "filter": { "categoryId": null, "top":5 } }
}

### R2) Revenue/profit series

POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "query($dateRange: DateRangeInput!, $groupBy: ReportGroupBy!) { reportRevenueProfitSeries(dateRange: $dateRange, groupBy: $groupBy) { statusCode success message data { period revenue profit } } }",
 "variables": { "dateRange": { "from": "2025-12-01T00:00:00Z", "to": "2025-12-31T00:00:00Z" }, "groupBy": "DAY" }
}

### ------------------------------------------------
### UPLOAD (Admin/Moderator)
### ------------------------------------------------

@publicId = myshop/temp-products/sample

### UP1) Upload image asset (GraphQL multipart request)
### Endpoint: `uploadProductAsset(file: Upload!)`
### NOTE:
### - JetBrains/VS Code REST Client syntax shown below.
### - Replace `./test.jpg` with an existing file path.
### - This mutation requires Authorization header.
POST {{host}}/graphql
Authorization: Bearer {{token}}
Content-Type: multipart/form-data; boundary=----MyBoundary

------MyBoundary
Content-Disposition: form-data; name="operations"

{"query":"mutation ($file: Upload!) { uploadProductAsset(file: $file) { statusCode success message data { url publicId } } }","variables":{"file":null}}
------MyBoundary
Content-Disposition: form-data; name="map"

{"0":["variables.file"]}
------MyBoundary
Content-Disposition: form-data; name="0"; filename="test.jpg"
Content-Type: image/jpeg

< ./test.jpg
------MyBoundary--

### UP2) Delete uploaded asset by publicId
POST {{host}}/graphql
Content-Type: application/json
Authorization: Bearer {{token}}

{
 "query": "mutation($publicId: String!) { deleteUploadedAsset(publicId: $publicId) { statusCode success message data } }",
 "variables": { "publicId": "{{publicId}}" }
}
